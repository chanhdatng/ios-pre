---
import { BookOpen, Calendar, Brain, BarChart3, Settings, Home, Code } from 'lucide-react';
import ThemeToggle from '../ui/ThemeToggle';

const navItems = [
  { href: '/', label: 'Dashboard', Icon: Home },
  { href: '/month-1', label: 'Month 1', Icon: Calendar },
  { href: '/month-2', label: 'Month 2', Icon: Calendar },
  { href: '/month-3', label: 'Month 3', Icon: Calendar },
  { href: '/leetcode', label: 'LeetCode', Icon: Code },
  { href: '/review', label: 'Review', Icon: Brain },
  { href: '/progress', label: 'Progress', Icon: BarChart3 },
  { href: '/settings', label: 'Settings', Icon: Settings },
];

const currentPath = Astro.url.pathname;
const basePath = import.meta.env.BASE_URL || '';

// Normalize path for comparison
const normalizedPath = currentPath.replace(basePath, '') || '/';
---

<aside
  class="w-64 h-screen bg-[var(--color-surface)] border-r border-[var(--color-surface-secondary)] p-[var(--spacing-lg)] sticky top-0 flex flex-col"
>
  <!-- Logo & Theme Toggle -->
  <div class="flex items-center justify-between mb-[var(--spacing-xl)]">
    <div class="flex items-center gap-[var(--spacing-sm)]">
      <BookOpen className="w-8 h-8 text-[var(--color-swift)]" />
      <span class="text-headline-3">iOS Prep</span>
    </div>
    <ThemeToggle client:load />
  </div>

  <!-- Navigation -->
  <nav class="space-y-[var(--spacing-xs)] flex-1">
    {
      navItems.map(({ href, label, Icon }) => {
        const isActive = normalizedPath === href;
        return (
          <a
            href={`${basePath}${href}`}
            class:list={[
              'nav-item',
              isActive && 'active',
            ]}
          >
            <Icon className="w-5 h-5" />
            <span>{label}</span>
          </a>
        );
      })
    }
  </nav>

  <!-- Due Cards Widget -->
  <div class="mt-auto">
    <div class="card p-[var(--spacing-md)]">
      <div class="metric-card">
        <span class="metric-label">Cards due today</span>
        <span class="metric-value" id="due-count">--</span>
      </div>
    </div>
  </div>
</aside>
